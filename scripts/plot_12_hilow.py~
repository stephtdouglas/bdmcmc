# Script to plot spectra for my sample
# Stephanie Douglas, 31 December 2013

import numpy as np
import matplotlib.pyplot as plt
import bdmcmc.sample.fetch as fetch


def plot_low(ax,bd,offset,label,pcolor='k'):

    wav = bd.specs['low']['wavelength']
    flu = bd.specs['low']['flux']
    unc = bd.specs['low']['unc']
    norm_by = np.average(flu[abs(wav-1.27)<0.005])
    flu = flu/norm_by
    unc = flu/norm_by

    ax.step(wav,flu+offset,color=pcolor)
    ax.text(2.2,0.6+offset,color=pcolor)
    ax.set_xlim(0.5,3)
    ax.set_ylim(-0.1,offset+1.2)



ldwarfs = fetch.fetch_12()
bds = ldwarfs.brown_dwarfs
unums = ldwarfs.keys()

offset_jump = 1.5
offset_start = 5*offset_jump
offset = offset_start
plt.figure(figsize=(9,12))
ax = plt.subplot(111)
for u in unums:
    plot_low(ax,bds[u],offset,u)
    if u==unums[5]:
        plt.figure(figsize=(9,12))
        ax = plt.subplot(111)
        offset = offset_start
    else:
        offset -= offset_jump
